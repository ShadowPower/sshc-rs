## sshc 命令行完全指南

欢迎使用 sshc！这是一个功能强大且易于使用的 SSH 连接管理器。本指南将详细介绍所有命令的用法，帮助您充分利用其功能。所有示例均使用简短格式，方便您快速上手。

--------------------------------------------------------------------------------

## 交互式连接 (默认操作)

这是最常用、最便捷的连接方式。

`sshc`

- 启动一个交互式的服务器列表，用于SSH 连接。列表高度会自动适应您的终端窗口大小，以显示尽可能多的选项。
- 使用 `↑` 和 `↓` 键进行选择，或使用 `PgUp` / `PgDn` 快速翻页。
- 直接输入字符即可进行实时筛选。
- 按 `回车键` 确认连接，按 `ESC` 键退出。

`sshc f`

- 同样启动交互式列表，但用于FileZilla 连接。

--------------------------------------------------------------------------------

## 命令: `connect` (别名: `c`)

直接通过 SSH 连接到一个已配置好的服务器，跳过交互式列表。

### 用法:

`sshc c <服务器名称>`

### 示例:

`sshc c prod-server`

--------------------------------------------------------------------------------

## 命令: `filezilla` (别名: `f`)

直接使用 FileZilla (SFTP) 连接到一个已配置好的服务器。

### 用法:

`sshc f <服务器名称>`

### 示例:

`sshc f prod-server`

--------------------------------------------------------------------------------

## 命令: `list` (别名: `l`)

以清晰、易读的格式列出所有已保存的服务器配置。

### 用法:

`sshc l`

--------------------------------------------------------------------------------

## 命令: `web` (别名: `w`)

启动一个本地 Web 服务器，提供一个图形化界面来轻松管理所有服务器配置。

### 用法:

`sshc w`

### 可选参数:

- `--bind <地址>`: 绑定地址（默认 `127.0.0.1`）。如需局域网访问可使用 `0.0.0.0`。
- `--port <端口>`: 指定端口（默认自动选择可用端口）。
- `--no-browser`: 不自动打开浏览器。

### 示例:

`sshc w --bind 0.0.0.0 --port 8080`
`sshc w --no-browser`

--------------------------------------------------------------------------------

## 命令: `upload` / `download` (别名: `up` / `down`)

在受限环境中通过 SSH 通道安全地传输文件和目录，并带有进度条。它的用法与 `scp` 命令类似。

### `upload` (别名: `up`)

将本地文件或目录上传到远程服务器。

#### 用法:

`sshc up <本地路径> <服务器名称:远程路径>`

#### 示例与说明:

- 上传到用户主目录 (保持原名)
  `sshc up ./local-file.txt my-server:`
  说明: 省略远程路径，文件将被上传到服务器上当前用户的主目录，即 `~/local-file.txt`。

- 上传到指定目录 (保持原名)
  `sshc up C:\data\archive.zip my-server:/opt/backups/`
  说明: 远程路径以 `/` 结尾，表示一个目录。文件将被上传到 `/opt/backups/archive.zip`。

- 上传并重命名文件
  `sshc up ./config.yaml my-server:~/app.yaml`
  说明: 远程路径不以 `/` 结尾，它指定了文件的最终名称和路径。

- 上传整个目录
  `sshc up ./my-project my-server:~/projects/`
  说明: 本地目录 `my-project` 将被完整上传到远程的 `~/projects/my-project`。

- 上传目录并重命名
  `sshc up ./dist my-server:/var/www/my-app`
  说明: 本地目录 `dist` 的内容将被上传到远程的新目录 `/var/www/my-app` 中。

### `download` (别名: `down`)

从远程服务器下载文件或目录到本地。

#### 用法:

`sshc down <服务器名称:远程路径> <本地路径>`

#### 示例与说明:

- 下载到当前目录 (保持原名)
  `sshc down my-server:/var/log/app.log .`
  说明: `.` 表示当前目录。文件将被下载到 `./app.log`。

- 下载到指定目录 (保持原名)
  `sshc down my-server:~/db_dump.sql C:\Backups\`
  说明: 本地路径以 `\` 结尾，表示一个目录。文件将被下载到 `C:\Backups\db_dump.sql`。

- 下载并重命名文件
  `sshc down my-server:/etc/nginx/nginx.conf ./nginx.backup.conf`
  说明: 本地路径不以分隔符结尾，它指定了文件的最终名称。

- 下载整个目录
  `sshc down my-server:/etc/nginx ./nginx_config_backup`
  说明: 远程目录 `/etc/nginx` 将被完整下载到本地的新目录 `./nginx_config_backup` 中。

--------------------------------------------------------------------------------

## 命令: `config` (别名: `conf`)

这是核心的配置管理模块，允许您在命令行中完成所有配置操作。

### 子命令: `config add` (别名: `a`)

添加一个新的服务器配置。

#### 用法:

`sshc conf a <新服务器名称> [参数...]`

#### 核心参数:

- `-h, --host <主机>`: (必填) 服务器的 IP 地址或域名。
- `-u, --user <用户>`: (必填) 登录所用的用户名。
- `-p, --port <端口>`: SSH 端口，默认为 `22`。
- `-n, --display-name <显示名>`: 在 TUI 和 Web UI 中显示的友好名称。
- `-i, --key <私钥文件>`: 指定私钥文件的路径，例如 `~/.ssh/id_rsa`。
- `--password <密码>`: 直接在命令行提供密码 (不安全，会记录在历史中)。
- `-P, --ask-pass`: 交互式地输入密码 (安全，输入时不可见)。
- `--store-plaintext`: 配合密码参数使用，将密码以明文形式存储 (不推荐)。

#### 高级参数:

- `-L <本地端口:远程主机:远程端口>`: 添加本地端口转发 (可多次使用)。
- `-R <远程端口:本地主机:本地端口>`: 添加远程端口转发 (可多次使用)。
- `-D <本地端口>`: 添加动态 SOCKS 转发 (可多次使用)。
- `-X, --x11`: 启用 X11 转发，用于图形界面程序。
- `-x, --prefix <前缀命令>`: 指定 SSH 前缀命令，例如 `trzsz` 以支持 trzsz。

#### 示例:

`sshc conf a company-jump -h jump.example.com -u bob -p 2222 -i ~/.ssh/company_key -n "公司跳板机"`
`sshc conf a dev-db -h 10.0.1.5 -u dev -P -L 5433:localhost:5432`

### 子命令: `config edit` (别名: `e`)

修改一个已存在的服务器配置。参数与 `add` 完全相同，您只需提供希望修改的参数即可，未提供的参数将保持其原有的值。

#### 示例 (仅修改 `company-jump` 的端口并启用 X11 转发):

`sshc conf e company-jump -p 2200 -X`

### 子命令: `config show` (别名: `s`)

显示指定服务器的详细配置信息。

#### 用法:

`sshc conf s <服务器名称>`

#### 示例:

`sshc conf s company-jump`

### 子命令: `config remove` (别名: `rm`)

删除一个服务器配置，操作前会请求确认。

#### 用法:

`sshc conf rm <服务器名称>`

#### 示例:

`sshc conf rm old-server`

--------------------------------------------------------------------------------

## 命令: `api`

为脚本和第三方工具集成设计的机器友好接口，所有输入输出均为 JSON 格式。

`api list`: 输出所有服务器名称的 JSON 数组。
`api get [名称]`: 输出指定服务器配置的 JSON 对象。若省略名称，则会输出所有服务器的配置集合。
`api set [-d <JSON>]`: 从标准输入 (stdin) 或 `-d/--data` 参数读取 JSON 来创建或更新服务器。
`api rm <名称>`: 删除服务器，无确认提示。

#### 示例:

`sshc api get prod-server`
`sshc api get`
`echo '{"name":"api-test","server":{"host":"api.host.com","user":"apiuser"}}' | sshc api set`
`sshc api set -d '{"name":"api-test2","server":{"host":"api2.host.com","user":"apiuser2"}}'`

--------------------------------------------------------------------------------

## 命令: `export` / `import`

用于在不同机器之间方便地迁移您的所有配置。

`export`: 读取当前所有配置，压缩并编码后，生成一条完整的 `import` 命令。
`import '<数据>'`: 导入由 `export` 命令生成的数据。

#### 迁移流程:

1. 在旧机器上运行: `sshc export`
2. 复制输出的整条 `sshc import '...'` 命令。
3. 在新机器上粘贴并运行该命令即可完成迁移。

--------------------------------------------------------------------------------

## 命令: `tutorial` (别名: `t`)

显示本教程。
